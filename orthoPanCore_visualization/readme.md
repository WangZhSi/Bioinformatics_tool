
# Pan-Core Genome Analysis Tool

This R script performs pan-genome and core-genome analysis using the output from OrthoFinder. It generates visualizations (PDF/PNG) and summary files classifying gene families into core, softcore, dispensable, and private categories.

## Installation

### Dependencies
Ensure the following R packages are installed:
```R
install.packages(c("optparse", "ggplot2", "tidyr", "dplyr", "tidyverse", "ggsci", "scales"))
```

## Usage

### Command Line Options
```bash
Rscript pan-core.R \
  -i <Orthogroups.GeneCount.tsv> \
  -o <output_directory> \
  [--simulation <number>] \
  [--core <threshold>] \
  [--softcore <threshold>] \
  [--private <threshold>]
```

| Parameter       | Description                                                                 |
|-----------------|-----------------------------------------------------------------------------|
| `-i/--input`    | **Required** Orthogroups.GeneCount.tsv file from OrthoFinder.              |
| `-o/--outdir`   | **Required** Output directory to save results.                             |
| `-s/--simulation`| Number of permutations for pan-core curve (default: 100).                  |
| `--core`        | Core genome threshold (default: 1.0 = 100% of samples).                    |
| `--softcore`    | Softcore genome threshold (default: 0.9 = 90% of samples).                 |
| `--private`     | Private genome threshold (default: 0.01, ensures at least 1 sample).       |

### Input File
The input file `Orthogroups.GeneCount.tsv` is generated by [OrthoFinder](https://github.com/davidemms/OrthoFinder) during its orthogroup analysis. It contains gene counts per orthogroup for each sample.

## Output Files
- **PanCoreGeneFamilies.pdf/png**: Pan-core genome accumulation curves.
- **GeneFamiliesFrequency.pdf/png**: Distribution of gene family frequencies.
- **ClassficationDonut.pdf/png**: Donut chart of gene family classification.
- **GeneFamiliesClassfication.txt**: Detailed classification of each orthogroup.
- **ClassficationSummary.txt**: Summary statistics of gene family categories.

## Example Command
```bash
Rscript pan-core.R \
  -i results/Orthogroups/Orthogroups.GeneCount.tsv \
  -o output \
  --simulation 200 \
  --core 0.95 \
  --softcore 0.8
```

## Reference

1. https://github.com/NotebookOFXiaoMing/SuperPangenomeofGrapevines